---
title: "species filters for NiN/biotope classification analyses - R Notebook"
output: html_notebook
authors: Rebecca Ross and Genoveva Gonzales-Mirelis
---

This script assumes that MarVid data has passed through the rStation and sample filters already, and will now undergo species filters that are common between NiN/biotope analyses. Some additional filters may only be applied on an analysis-specific basis - these are found within the analyses projects themselves (e.g. deepseaNiN or twinspanBiotopes).

#libraries
```{r}
library(tidyr)
library(dplyr)
```


# Inputs
- Assumes have run config and stationFilters scripts already.
- Needs Taxonary

#Filter taxonary

RULES

- Remove object_type !=Organism
```{r}
t.org <-subset(taxonary, Object_type=="Organism" )
```


- Remove specificity =4
```{r}
t.orgSpec<-subset(t.org, Specificity<4)
```

- Remove Size_class = Macro
```{r}
t.orgSpecMega<-subset(t.orgSpec, Size_class=="Mega")
```


- Remove ecosystem_section = Demersal/Hyperbenthic
```{r}
t.orgSpecMegaBenthic<-subset(t.orgSpecMega, Ecosystem_section=="Benthic" )
```


# Select from sppdens (stationFiltered) object

```{r}

```






#Output
Will be wide format of filtered speices list applied to the species_densities object that has been filtered for stations..

```{r}
#temporary code to make working object

wideData <- sppdens %>% select(-c(TotAbu_pseudocount)) %>%
  mutate(clean_taxonomy = gsub(" ","_",clean_taxonomy)) %>%
  mutate(clean_taxonomy = gsub("\\..*","",clean_taxonomy, fixed=FALSE)) %>%#removes whats after the ;
  mutate(clean_taxonomy = tolower(clean_taxonomy)) %>%
  pivot_wider(names_from = clean_taxonomy, values_from = density_n100m2, values_fill = 0, values_fn = sum)

head(wideData)

```

